!function(n,t,r){_XenForoQuickReply=XenForo.QuickReply,XenForo.QuickReply=function(u){_XenForoQuickReply(u);var f=XenForo.MultiSubmitFix(u);this.scrollAndFocus=function(){return n(r).scrollTop(u.offset().top),t.tinyMCE?t.tinyMCE.editors.ctrl_message_html.focus():n("#QuickReply").find("textarea:first").get(0).focus(),this},u.data("QuickReply",this).unbind("AutoValidationComplete").bind({AutoValidationComplete:function(r){if(r.ajaxData._redirectTarget&&(t.location=r.ajaxData._redirectTarget),n('input[name="last_date"]',u).val(r.ajaxData.lastDate),f&&f(),u.find("input:submit").blur(),u.hasClass("QuickReplyLive")){if(n('input[name="last_position"]',u).val(r.ajaxData.lastPosition),n("form.InlineModForm").data("timestamp",r.ajaxData.lastDate),r.ajaxData.posts&&r.ajaxData.posts.length)for(i=0;i<r.ajaxData.posts.length;i++)n(r.ajaxData.posts[i]).xfInsert("appendTo",n("ol#messageList"),"xfSlideDown")}else new XenForo.ExtLoader(r.ajaxData,function(){n("#messageList").find(".messagesSinceReplyingNotice").remove(),n(r.ajaxData.templateHtml).each(function(){this.tagName&&n(this).xfInsert("appendTo",n("#messageList"))})});return n("#QuickReply").find("textarea").val(""),t.tinyMCE&&t.tinyMCE.editors.ctrl_message_html.setContent(""),t.sessionStorage&&(t.sessionStorage.quickReplyText=null),u.trigger("QuickReplyComplete"),u.hasClass("QuickReplyLive")&&(n(".AttachmentEditor").find(".AttachmentList.New li:not(#AttachedFileTemplate)").xfRemove(),u.data("isReplying",0)),!1}})},XenForo.QuickReplyTrigger=function(i){i.click(function(){var u=null,f=null,e=null;return i.is(".MultiQuote")?(u=n(i.data("form")),e={postIds:n(i.data("inputs")).map(function(){return this.value}).get()}):(u=n("#QuickReply"),u.data("QuickReply").scrollAndFocus()),f||(f=XenForo.ajax(i.data("posturl")||i.attr("href"),e,function(n){if(XenForo.hasResponseError(n))return!1;delete f;var e=XenForo.getEditorInForm(u);if(!e)return!1;e.execCommand?(tinyMCE.isIE?e.execCommand("mceInsertContent",!1,n.quoteHtml):e.execCommand("insertHtml",!1,n.quoteHtml),t.sessionStorage&&(t.sessionStorage.quickReplyText=n.quoteHtml)):(e.val(e.val()+n.quote),t.sessionStorage&&(t.sessionStorage.quickReplyText=n.quote)),i.is(".MultiQuote")&&u.trigger("MultiQuoteComplete")})),!1})}}(jQuery,this,document);