!function(n,t,r){var f=XenForo.QuickReply;XenForo.QuickReply=function(u){var o=XenForo.getEditorInForm(u),e;if(o.$editor)return f(u);f(u),e=XenForo.MultiSubmitFix(u),this.scrollAndFocus=function(){return n(r).scrollTop(u.offset().top),t.tinyMCE?t.tinyMCE.editors.ctrl_message_html.focus():n("#QuickReply").find("textarea:first").get(0).focus(),this},u.data("QuickReply",this).unbind("AutoValidationComplete").bind({AutoValidationComplete:function(r){if(r.ajaxData._redirectTarget&&(t.location=r.ajaxData._redirectTarget),n('input[name="last_date"]',u).val(r.ajaxData.lastDate),e&&e(),u.find("input:submit").blur(),u.hasClass("QuickReplyLive")){if(n('input[name="last_position"]',u).val(r.ajaxData.lastPosition),n("form.InlineModForm").data("timestamp",r.ajaxData.lastDate),r.ajaxData.posts&&r.ajaxData.posts.length)for(i=0;i<r.ajaxData.posts.length;i++)n(r.ajaxData.posts[i]).xfInsert("appendTo",n("ol#messageList"),"xfSlideDown")}else new XenForo.ExtLoader(r.ajaxData,function(){n("#messageList").find(".messagesSinceReplyingNotice").remove(),n(r.ajaxData.templateHtml).each(function(){this.tagName&&n(this).xfInsert("appendTo",n("#messageList"))})});return n("#QuickReply").find("textarea").val(""),t.tinyMCE&&t.tinyMCE.editors.ctrl_message_html.setContent(""),t.sessionStorage&&(t.sessionStorage.quickReplyText=null),u.trigger("QuickReplyComplete"),u.hasClass("QuickReplyLive")&&(n(".AttachmentEditor").find(".AttachmentList.New li:not(#AttachedFileTemplate)").xfRemove(),u.data("isReplying",0)),!1}})},XenForo.QuickReplyTrigger=function(t){t.click(function(){var r=null,u=null,f=null;return t.is(".MultiQuote")?(r=n(t.data("form")),f={postIds:n(t.data("inputs")).map(function(){return this.value}).get()}):(r=n("#QuickReply"),r.data("QuickReply").scrollAndFocus()),u||(u=XenForo.ajax(t.data("posturl")||t.attr("href"),f,function(n){if(XenForo.hasResponseError(n))return!1;delete u;var f=XenForo.getEditorInForm(r);if(!f)return!1;f.execCommand&&!f.$editor?f.execCommand("insertHtml",!1,n.quoteHtml):f.$editor?(f.insertHtml(n.quoteHtml),f.$editor.data("xenForoElastic")&&f.$editor.data("xenForoElastic")()):f.val(f.val()+n.quote),t.is(".MultiQuote")&&r.trigger("MultiQuoteComplete")})),!1})}}(jQuery,this,document);