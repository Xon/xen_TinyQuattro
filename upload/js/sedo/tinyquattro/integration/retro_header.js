!function(n,t,i,r){var f=XenForo.scriptLoader.loadScript,e,u;XenForo.scriptLoader.loadScript=function(n,i,r){var u="js/sedo/tinyquattro/tinymce",e=new RegExp(u+"/tinymce(.min)?.js");e.test(n)&&(t.tinyMCEPreInit={baseURL:XenForo.baseUrl()+u,suffix:/\.min\.js/.test(n)?".min":""}),f(n,i,r)},n.fn.extend({_quattro_jqSerialize:n.fn.serialize,serialize:function(){if(t.tinyMCE)try{t.tinyMCE.triggerSave()}catch(n){}return this._quattro_jqSerialize()},_quattro_jqSerializeArray:n.fn.serializeArray,serializeArray:function(){if(t.tinyMCE)try{t.tinyMCE.triggerSave()}catch(n){}return this._quattro_jqSerializeArray()}}),XenForo.getEditorInForm=function(i,u,f,e){var h,o,s;if(e||(u=""),$form=n(i),$messageEditors=$form.find("textarea.MessageEditor"+(u||"")),$bbCodeEditors=$form.find(".bbCodeEditorContainer textarea"+(u||"")),$allEditors=$messageEditors.add($bbCodeEditors),$messageEditors.length==0)return!1;if($messageEditor=$messageEditors.eq(0),$bbCodesBbCodeEditor=$bbCodeEditors.eq(0),f&&typeof f!==r&&(h=f.get(0),o=!1,typeof h.id!==r&&($allEditors.each(function(){if(n(this).attr("id")==h.id){o=n(this);return}}),o)))return o.focus(),o;if(t.tinyMCE){var a=tinyMCE.activeEditor,l=n(a.getElement()),v=l.attr("id"),c=!1;if($messageEditors.each(function(){if(n(this).attr("id")==v){c=!0;return}}),a&&c&&!l.attr("disabled"))return tinyMCE.activeEditor;if(s=$messageEditor.attr("id"),s&&typeof tinyMCE.editors[s]!==r&&!$messageEditor.attr("disabled"))return tinyMCE.editors[s]}return $messageEditor.attr("disabled")?$bbCodesBbCodeEditor.length?$bbCodesBbCodeEditor:!1:$messageEditor},e=XenForo.speed.normal,u=XenForo.speed.fast,XenForo.AttachmentInserter=function(r){var u=!1;r.hover(function(){u=n(i.activeElement)}),r.click(function(i){function a(n,t){return n.hasClass("NoAttachment")&&n.hasClass("ImgFallback")?h:t}var c=r.closest(".AttachedFile").find(".Thumbnail a"),s=c.data("attachmentid"),f,e,h,o,v=XenForo._baseUrl,y=c.find("img").attr("src"),l=c.attr("href");i.preventDefault(),r.attr("name")=="thumb"?(e="[ATTACH]"+s+"[/ATTACH] ",h="[img]"+v+y+"[/img]",o='<img src="'+y+'" class="attachThumb bbCodeImage" alt="attachThumb'+s+'" /> '):(e="[ATTACH=full]"+s+"[/ATTACH] ",h="[img]"+v+l+"[/img]",o='<img src="'+l+'" class="attachFull bbCodeImage" alt="attachFull'+s+'" /> '),f=XenForo.getEditorInForm(r.closest("form"),"",u),f.execCommand&&t.tinyMCE?($textarea=n(f.getElement()),o=a($textarea,o),f.execCommand("mceInsertContent",!1,o)):(e=a(f,e),f.val(f.val()+e))})},XenForo.AttachmentDeleter=function(t){t.css("display","block").click(function(t){var i=n(t.target),s=i.attr("href")||i.data("href"),f=i.closest(".AttachedFile"),h=i.closest(".AttachedFile").find(".Thumbnail a"),e=h.data("attachmentid"),o;if(s)return f.xfFadeUp(XenForo.speed.normal,null,u,"swing"),XenForo.ajax(s,"",function(n){if(XenForo.hasResponseError(n))return f.xfFadeDown(XenForo.speed.normal),!1;var i=f.closest(".AttachmentEditor");f.xfRemove(null,function(){i.trigger("AttachmentsChanged")},u,"swing")}),e&&(o=XenForo.getEditorInForm(i.closest("form"),":not(.NoAttachment)",!1,!0),typeof o.getBody()!==r&&n(o.getBody()).find("img[alt=attachFull"+e+"], img[alt=attachThumb"+e+"]").remove()),!1;console.warn("Unable to locate href for attachment deletion from %o",i)})}}(jQuery,this,document,"undefined");