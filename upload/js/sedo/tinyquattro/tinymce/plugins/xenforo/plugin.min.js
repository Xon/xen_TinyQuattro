(function(d,A,y,g){xenMCE==g&&(xenMCE={});xenMCE.Lib={getTools:function(){return this.Tools},overlay:{create:function(a,b,c){xenMCE.Lib.Tools.loadOverlay(a,b,c)},get:function(){return xenMCE.Lib._get("$overlay")},getParams:function(){return xenMCE.Lib._get("params")},getInputs:function(){return xenMCE.Lib._get("inputs")},getEditor:function(){return xenMCE.Lib._get("editor")},getSelection:function(){return xenMCE.Lib._get("selection")}},_get:function(a){var b=xenMCE.Tools.backupLib;return b[a]!==g?
b[a]:!1}};xenMCE.Templates={};tinymce.create("xenMCE.Tools",{Tools:function(a){var b=this;a===g&&(a=tinymce.activeEditor);this.getEditor=function(){return a};a.on("init",function(b){d(a.getElement()).data("mce4",!0).attr("disabled",!1)});this.$textarea=d(a.getElement());this.isOldXen=b.getParam("oldXen");this.getForm=function(){var b=d(a.getContainer()).closest("form");b.length||console.info("Form not found - check mce event");return b};a.on("init",function(b){b=a.windowManager;var e=b.open;b.open=
function(b,c){b===g&&(b=!1);c===g&&(c=!1);var d={args:b,params:c};a.fire("XenModalInit",d);var k=e(b,c),d={modal:k,args:b,params:c};a.fire("XenModalComplete",d);return k}});this.isFullscreen=function(b){return a.plugins.fullscreen===g?!1:a.plugins.fullscreen.isFullscreen()};xenMCE.Lib.Tools=this;a.on("XenReady",function(){xenMCE.Plugins.Auto!==g&&d.each(xenMCE.Plugins.Auto,function(c,e){new e(b,a)})})},overlayParams:{},overlayInputs:{},overlayCache:{},loadOverlay:function(a,b,c){if(1==this.xenOverlayIsloading)return!1;
this.xenOverlayIsloading=!0;var e=this.getEditor(),h=e.dom,f=isLink=isEmail=!1,l=url_href="",k=e.selection,m,n,r=xenMCE.Tools.backupLib,p=tinymce.each;this.dialog=a;this.findTargetWindow=function(b){var a=e.windowManager.windows,c=!1;p(a,function(a){if(a.params!=g&a.params.dialogName==b)return c=a,!1});return c||a[0]===g?c:a[0]};selElm=k.getNode();if(anchorElm=h.getParent(selElm,"a[href]"))f=!0,k.select(anchorElm),l=k.getContent({format:"text"}),url_href=anchorElm?h.getAttrib(anchorElm,"href"):"",
isEmail=0==url_href.indexOf("mailto")&&0<url_href.indexOf("@")&&-1==url_href.indexOf("//")?!0:!1,isLink=!isEmail;h=this.getAnchors(url_href);m=e.settings.xen_attach.split(",");this.xenAttach={type:m[0],id:m[1],hash:m[2]};m=k.getContent();n=k.getContent({format:"text"});r.selection={sel:k,text:n,html:m,isUrl:f,isLink:isLink,isEmail:isEmail,url:{text:l,href:url_href,anchorElm:anchorElm},anchorList:h};if(k=this.findTargetWindow(a))return k.show(),this.xenOverlayIsloading=!1;"object"!==typeof b&&(b={});
this.overlayParams={dialog:a,src:this.isDefined(c,"src"),onbeforeload:this.isDefined(c,"onbeforeload"),onafterload:this.isDefined(c,"onafterload"),onsubmit:this.isDefined(c,"onsubmit"),onclose:this.isDefined(c,"onclose"),wmConfig:b};b={dialog:a,selectedHtml:m,selectedText:n,isUrl:f,isLink:isLink,isEmail:isEmail,urlDatas:{text:l,href:url_href},anchorList:h,attach:this.xenAttach};c=d(y).find("#mce4_cache_"+a);this.overlayCache[a]!==g&&c.length?this._overlayFormatter(c.html(),!1,!0,b):XenForo.ajax("index.php?editor/quattro-dialog",
b,d.proxy(this,"_overlayLoader"))},_overlayLoader:function(a){if(XenForo.hasResponseError(a)||"string"!==typeof a.templateHtml)this.xenOverlayIsloading=!1;else{for(var b=this,c='<div><div class="mce-xen-body">'+a.templateHtml+"</div></div>",e=/<script[^>]*>([\s\S]*?)<\/script>/ig,h,f=[];h=e.exec(c);)f.push(h[1]);c=c.replace(e,"");b.overlayCache[b.dialog]=this.xenAttach.hash;$cache=d('<div id="mce4_cache_'+b.dialog+'">'+c+"</div>").hide();d(y).find("body").append($cache);new XenForo.ExtLoader(a,function(){b._overlayFormatter(c,
f)})}},_overlayFormatter:function(a,b,c,e){function h(a){$inputs=a.find(z.toString());0<$inputs.length&&$inputs.each(function(a){(a=d(this).attr("name"))&&(r[a]=d(this).val())});a.find("*").filter(function(){d(this).data("value")&&(r[d(this).attr("name")]={html:d(this).html(),text:d(this).text(),data:d(this).data("value")});1==parseInt(d(this).data("hide"))&&d(this).hide()});f.overlayInputs=r;return w.inputs=r}var f=this,l=this.getEditor(),k=this.overlayParams,m=k.wmConfig,n=l.windowManager,r={},
p=f.ucfirst(f.dialog),q=f.getPhrase("insert"),u=f.getPhrase("cancel"),z=f.getInputTags(),w=xenMCE.Tools.backupLib;w.params=k;w.editor=l;$html=d(a);$title=$html.find(".mceTitle").remove();$Submit=$html.find(".mceSubmit").remove();$Cancel=$html.find(".mceCancel").remove();1==$Submit.length&&(q=f.getTagName($Submit,!0));1==$Cancel.length&&(u=f.getTagName($Cancel,!0));h($html);$title&&(m.title=$title.text());m.title!==g&&m.title||(m.title=f.getPhrase("notitle"));a=f.getParam("overlayDefaultSize");m.width===
g&&(m.width=a.w);m.height===g&&(m.height=a.h);$title.data("width")!==g&&(m.width=parseInt($title.data("width")));$title.data("height")!==g&&(m.height=parseInt($title.data("height")));m.data!==g?(d.each(m.data,function(a,b){$e=$html.find("[name="+a+"]");1==$e.length&&(f.getTagName($e,z)?d('<span class="tmp-data-mce">'+b+"</span>").insertAfter($e).hide():$e.html(b))}),d.extend(m.data,r)):m.data=r;m.onsubmit!==g&&(originalSubmit=m.onsubmit,m.onsubmit=function(a){var b=f.findTargetWindow(f.dialog),b=
d(b.getEl()),c=h(b);d.extend(a.data,c);originalSubmit(a,b,l,f)});m.buttons===g&&(m.buttons=[{text:q,subtype:"primary xenSubmit",minWidth:80,onclick:function(a){var b=f.findTargetWindow(f.dialog),c=d(b.getEl());if(0!=k.onsubmit){var e=h(c);d.extend(a.data,e);k.src[k.onsubmit](a,c,l,f)}b.find("form")[0]!==g?b.find("form")[0].submit():b.submit();0!=k.onclose&&(e=h(c),d.extend(a.data,e),k.src[k.onclose](a,c,l,f));b.close()}},{text:u,subtype:"xenCancel",onclick:function(a){var b=d(v.getEl());if(0!=k.onclose){var c=
h(b);d.extend(a.data,c);k.src[k.onclose](a,b,l,f)}v.close()}}]);m.html=$html.html();0!=k.onbeforeload&&(q=k.src[k.onbeforeload](m,f),q!==g&&(m=q));n.open(m,{dialogName:k.dialog,modalClassName:k.dialog,ovlParams:k});var v=f.findTargetWindow(f.dialog,!0),m=d(v.getEl());xenMCE.Tools.backupLib.$overlay=m;if(b.length&&b!==g)for(n=0;n<b.length;n++)d.globalEval(b[n]);b=m.find(".mce-container-body").height();m.find(".mceFocus").focus();m.find(".tmp-data-mce").each(function(){$e=d(this);$e.prev().val($e.html());
$e.remove()});$tabs=m.find(".mceTabs").addClass("mce-tabs");$tabs=f.cleanWhiteSpace($tabs);$panes=$tabs.next(".mcePanes").children().addClass("mce-pane");0<$tabs.length&&0<$panes.length&&($tabs.children().addClass("mce-tab"),n=$tabs.find(".mceActive").index(),$tabs.tabs($panes,{current:"mce-active",initialIndex:0<=n?n:0}));$slides=m.find(".mceSlides");0<$slides.length&&($slides.height(b).children().height(b-$slides.data("diff")),$slider_tabs=m.find(".mceSlidesTabs"),d('<a class="mceSlidesNavig mceSlidesBackward">&lsaquo;</a><a class="mceSlidesNavig mceSlidesForward">&rsaquo;</a>').insertBefore($slides),
m.find(".mceSlidesNavig").css("top",b/2-10+"px"),$slider_tabs.tabs($slides.children(),{effect:"fade",fadeOutSpeed:"fast",rotate:!0}).slideshow({prev:".mceSlidesBackward",next:".mceSlidesForward",clickable:!1}));if($multi=m.find("textarea, .mce-multiline"))v.off("keydown"),$multi.attr("spellcheck","false").attr("hidefocus","true");$checkBox=m.find(".xenCheckBox");0<$checkBox.length&&($checkBox.each(function(a){var b=d(this).data("phrase")||"",c=d(this).data("inputname");a="checked"==d(this).data("checked")?
1:0;b='<i class="mce-ico mce-i-checkbox"></i><span>'+b+'</span><input name="'+c+'" type="hidden" value="'+a+'" />';a&&d(this).addClass("mce-checked");d(b).prependTo(d(this))}),f._initCheckBox($checkBox));m.xfActivate();if(!$title.hasClass("FastReload"))delete f.overlayCache[f.dialog];else if(c&&(e.isUrl||f._inlineLink(e),f._onFastReload(m,e),f.isDefined(xenMCE.Templates[p],"onfastreload")))xenMCE.Templates[p].onfastreload(m,e,l,f);if(0!=k.onafterload)k.src[k.onafterload](m,r,l,f);else if(f.isDefined(xenMCE.Templates[p],
"onafterload"))xenMCE.Templates[p].onafterload(m,r,l,f);f.xenOverlayIsloading=!1},_onFastReload:function(a,b){var c=this.getInputTags();c.push("textarea");d.each(c,function(b,c){a.find(c+".MceReset").val("")});if(b.isUrl){var c=b.urlDatas,e;b.isLink?e="input.MceLink":b.isEmail&&(e="input.MceEmail");a.find(e).val(c.href);a.find(e+"Text").val(c.text)}else d.each(c,function(c,e){a.find(e+".MceSelec").val(b.selectedText);a.find(e+".MceSelecHtml").val(b.selectedHtml)})},_inlineLink:function(a){var b=this.getUrlRegex(),
c=this.getMailRegex(),e=a.selectedText;if(e.length){var d=function(){a.isUrl=!0;a.urlDatas.text=a.urlDatas.href=e};b.test(e)&&(a.isLink=!0,d());c.test(e)&&(a.isEmail=!0,d())}},_initCheckBox:function(a){a.children("i").unbind("click").bind("click",function(a){$parent=d(this).parent();$input=d(this).siblings("input");parseInt($input.val())?($parent.removeClass("mce-checked"),$input.val(0)):($parent.addClass("mce-checked"),$input.val(1))})},responsiveModal:function(a){var b=d(a.getEl()),c=b.children(".mce-container-body");
(function(){var e=(d(window).width()-b.width())/2,h=b.find(".mce-xen-body"),f=h.css("overscroll");b.find("mce-foot");if(0>e){e=1;a.classes.add("responsive");b.children().add(h).addClass("responsive");var l=d(window).width(),k=l-5,m=b.find("*").filter(function(){function a(b){if(-1!=b.indexOf("%"))return!1;if(parseInt(b)>=l)return d(this).data("owidth")||d(this).data("owidth",b),!0}var b=d(this).prop("style").width,c=d(this).css("width"),b=a(b);if(1==b)return!0;b=a(c);return d(this).css("width")==
d(this).parent().css("width")?!1:1==b?!0:!1}),g=b.find("*").filter(function(){var a=d(this).css("white-space");return"normal"==a||d(this).data("onw")?!1:(d(this).data("onw",a),!0)});m.add(b).css({"max-width":k+"px"});b.find(".responsiveBlock").css({"max-width":k-15+"px"});b.find(".mainBodyOverflow").length&&c.css("overflow","auto");0==b.find(".disableXenBodyOverflow").length&&h.data("ovsc",f).css("overflow","auto");g.css({"white-space":"normal"})}b.css({left:e})})()},isDefined:function(a,b){return b===
g?a===g?!1:a:a===g||a[b]===g?!1:a[b]},getTagName:function(a,b,c){var e=a.get(0).tagName.toLowerCase();if(c===g&&b===g)return e;b!==g&&"boolean"!==typeof b&&(c=b);if(!0===b)return b=this.getInputTags(),-1!==d.inArray(e,b)?a.val():a.text();if("object"===typeof c){var h=[];d.each(c,function(a,b){h.push(b.toLowerCase())});return-1!=d.inArray(e,h)?!0:!1}return e==c.toLowerCase()?!0:!1},cleanWhiteSpace:function(a){a.contents().filter(function(){return 3==this.nodeType&&!/\S/.test(this.nodeValue)}).remove();
return a},isActiveButton:function(a,b){var c=this.getEditor(),e=tinymce.each,d=[];b=1==b;for(var f=1;c.settings["toolbar"+f]!==g;f++)d=d.concat(c.settings["toolbar"+f].split(" "));b||0==c.settings.menubar||c.settings.menu==g||e(c.settings.menu,function(a,b){a.items!=g&&(d=d.concat(a.items.split(" ")));d.push(b)});return-1==tinymce.inArray(d,a)?!1:!0},getButtonByName:function(a,b){var c=this.getEditor(),e=c.buttons,c=c.theme.panel.find("toolbar *");if(e[a]===g)return!1;var d=e[a],f=!1,l=0;tinymce.each(d,
function(a,b){l++});tinymce.each(c,function(a,c){if("button"==a.type&&a.settings!==g){var e=0;tinymce.each(a.settings,function(a,b){d[b]==a&&e++});if(e==l)return f=a,0!=b&&(f=a.getEl()),!1}});return f},getPathEl:function(a){var b=this.getEditor();if(b=b.theme.panel&&b.theme.panel.find("#statusbar")[0])if(b=b.find(".path"),b[0]!==g)return b=b[0].getEl(),1==a?d(b):b;return!1},getButtonsByProperty:function(a,b,c){var e=this.getEditor().theme.panel.find("toolbar *"),h={};tinymce.each(e,function(c,e){var f=
c.settings;-1!==d.inArray(c.type,["button","splitbutton"])&&f!==g&&(b!==g&&f[a]!==g&&f[a]==b?h[e]=c:b!==g&&null!==b||f[a]===g||(h[e]=c))});if(c!==g){var f=d();d.each(h,function(a,b){f=f.add(d(b.getEl()))});h=f}if("object"===typeof c&&c instanceof jQuery){var l=[];d.each(h,function(a,b){l.push("#"+d(b).attr("id"))});l=l.toString();h=c.find(l).addClass("_tmp_").find(">:first-child").parents("._tmp_").removeClass("_tmp_")}return h},getMenubar:function(){var a=this.getEditor().theme.panel.find("menubar");
return a[0]!==g?d(a[0].getEl()):d()},getToolbars:function(a){var b=this.getEditor().theme.panel.find("toolbar"),c=b.parent(),e=parseInt(this.getParam("tglMenuMode"));return e||a!==g?b.slice(e):c},addIconClass:function(a,b){return a.find("i.mce-ico").addClass("mce-"+b+"-icons")},buildMenuItems:function(a,b,c,e){var d=[],f=[],l;b===g&&(b=a);tinymce.each(b.split(/\|/),function(a){f.push(a)});tinymce.each(a.split(/\|/),function(a,b){l=f[b]!==g?f[b]:"";if(c===g||null==c)return d.push({text:a,value:l});
var n={title:a,text:a,value:l,textStyle:c.replace(/{t}/g,a).replace(/{v}/g,l)};e!==g&&(n.classes=e);d.push(n)});return d},createListBoxChangeHandler:function(a,b,c){var e=this.getEditor();return function(d){var f=this;"function"===typeof c&&c(f,d);e.on("nodeChange",function(c){if(!f.nodeChangeOff){var d=e.formatter,h=null;tinymce.each(c.parents,function(c){tinymce.each(a,function(a){b?d.matchNode(c,b,{value:a.value})&&(h=a.value):d.matchNode(c,a.value)&&(h=a.value);if(h)return!1});if(h)return!1});
f.value(h);f.resetText&&f.text("")}})}},fixBtnFullscreen:function(a,b,c){if(!this.isFullscreen())return!1;var e=d(a.getEl());a=c===g?d(a[b].getEl()):d(c.getEl());b=e.offset();c=e.position();this.isFullscreen()?b.top=c.top+e.height()+parseInt(a.css("marginTop")):b.top=b.top+e.height()+parseInt(a.css("marginTop"));a.offset(b)},handleDisabledState:function(a,b){function c(){a.disabled(!d.getParent(f.getStart(),b));f.selectorChanged(b,function(b){a.disabled(!b)})}var e=this.getEditor(),d=e.dom,f=e.selection;
if(e.initialized)c();else e.on("init",c)},insertBbCode:function(a,b,c){a=a.replace(/^at_/,"");var e=this.getEditor(),d=e.dom,f="["+a;a="[/"+a+"]";c||(c=e.selection.getContent());e.execCommand("mceInsertContent",!1,(b?f+("="+b+"]"):f+"]")+(c+'<span id="MceCaretBb"></span>')+a);e.selection.select(d.get("MceCaretBb"));d.remove("MceCaretBb")},getParam:function(a){var b=this.getEditor().getParam("xenParams");if(b===g)return null;if(b[a]!==g)return b[a];console.log("This param was not found: "+a);return null},
getPhrase:function(a,b){var c=xenMCE.Phrases;if(c[a]===g)return"";if(b!==g){if(c[a][b]!==g)return c[a][b]}else return c[a];return""},getInputTags:function(){return["input","textarea","select"]},getAnchors:function(a){var b=this.getEditor(),c=[];tinymce.each(b.dom.select("a:not([href])"),function(b){b=b.name||b.id;a||(a="");b&&c.push({text:b,value:"#"+b,selected:-1!=a.indexOf("#"+b)})});return c},alterTagBeforeComplete:function(a,b,c){var e=this.getEditor(),h=tinymce.each,f=this;this._alterTagQueue===
g&&(this._alterTagQueue=[]);this._alterTagQueue.push([a,b,c]);e.on("xenMceBeforeSubmit XenSwitchToBbCode",function(a){var b=!0,c=e.dom,g=c.clone(e.getBody(),!0),r=["SPAN"],p=function(a,b,e){var f=[];h(c.select(a,g),function(h,l){if(e&&-1!=tinymce.inArray(r,h.nodeName)){var g=tinymce.dom.DomQuery,k=g(h).next(),p=" ",n=!1,q=d(h).nextAll(a).length,x=g(h).text(),B=g(h).parent().text();q||x!=B?q&&g(k).is("br")&&(n=k,p="<br />",k=g(k).next(),(g=h.nextSibling.nextSibling)&&3===g.nodeType&&(k=!1)):(k=g(h).parent("p").next().children().first(),
p="<br />");if(k=k[0])if(g=k.nodeName,k=c.getAttrib(k,"class"),q=h.nodeName,x=c.getAttrib(h,"class"),q==g&&x==k){f.push(h.innerHTML);p=c.getParent(h,"p");c.remove(h);p&&!p.innerHTML?c.remove(p):n&&c.remove(n);return}}if(n=b(c,h))e&&0<f.length&&(p=f.join(p)+p,n.innerHTML=p+n.innerHTML),c.replace(n,h),f=[]},"childNodes")};h(f._alterTagQueue,function(a){p.apply(f,a)});var q=e.serializer.serialize(g,{format:"html",get:!0,getInner:!0});e.on("SaveContent",function(a){b&&q&&(a.content=q,b=!1)});"xenswitchtobbcode"==
a.type&&(a.content=q)})},ucfirst:function(a){return a.charAt(0).toUpperCase()+a.slice(1)},unescapeHtml:function(a,b){a=a.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#039;/g,"'");"noBlank"==b&&(a=a.replace(/\t/g,"\t").replace(/&nbsp;/g,"  ").replace(/<\/p>\n<p>/g,"\n"));var c=/^<p>([\s\S]+)<\/p>$/i;c.test(a)&&(a=a.match(c),a=a[1]);return a},escapeHtml:function(a,b){"onlyBlank"!==b&&(a=a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,
"&quot;").replace(/'/g,"&#039;"));"noBlank"!==b&&(a=a.replace(/\t/g,"\t").replace(/ /g,"&nbsp;").replace(/\n/g,"</p>\n<p>"));return a},stripTags:function(a){return a.replace(/<[^>]+>/ig,"")},getUrlRegex:function(){return/^(?:s+)?(?:(?:https?|ftp|file):\/\/|www.|ftp.)[-a-zA-Z0-9+&@#/%=~_|$?!:,.]*[-a-zA-Z0-9+&@#/%=~_|$](?:s+)?$/i},getMailRegex:function(){return/^(?:s+)?[A-Z0-9._%+-]+@[A-Z0-9.-]+.[A-Z]{2,4}(?:s+)?$/i},getSelection:function(){return xenMCE.Lib._get("selection")},zen2han:function(a){var b,
c="",e,d;e=0;for(d=a.length;e<d;e++)b=a.charCodeAt(e),b=65281<=b&&65392>=b?b-65248:b,b=12540===b?45:b,c+=String.fromCharCode(b);return c},"static":{backupLib:{}}});tinymce.PluginManager.add("xenforo",xenMCE.Tools);tinymce.PluginManager.add("xenReady",function(a){a.fire("XenReady")});tinymce.create("xenMCE.Plugins.Auto.BbmButtons",{BbmButtons:function(a,b){d.extend(this,a);this.ed=b;var c=this,e=c.getParam("bbmButtons");d.each(e,function(e,f){var l=f.code;config={name:l,tooltip:f.desc};"manual"==f.type?
(config.icon=l,f.typeOpt&&(config.classes=f.typeOpt)):"text"==f.type?(config.icon=!1,config.text=f.typeOpt):"icons_fa"==f.type?(config.icon=!1,config.faFont=f.typeOpt,config.onPostRender=function(){var a=this.settings.faFont;d(this.getEl()).find("i").addClass("fa "+a)}):"xenCustom"==f.type?(config.icon=!1,config.onPostRender=function(){d(this.getEl());this.classes.add("xen-custom")}):(config.icon=l,config.iconset=f.iconSet);"direct"==f._return?config.onclick=function(a){c.insertBbCode(e,f.tagOpt,
f.tagCont)}:"kill"!=f._return&&(config.onclick=function(a){c.bbm_tag=e;c.bbm_separator=f.separator;c.loadOverlay("bbm_"+f.template,{onsubmit:c.submit},{src:c,onafterload:"onafterload",onclose:"onclose"})});var k=function(a){c.ed.addButton(l,a);a=d.extend({},a);a.text==g&&(a.text=f.desc,a.tooltip=!1,a.context="insert");c.ed.addMenuItem(l,a)};"kill"==f._return?a.isActiveButton(f.code)?d.extend(b.buttons[f.code],config):console.debug('Button "'+f.code+'" not found - Delete it from BBM'):k(config)});
c.isActiveButton("code",!0)&&(c.ed.buttons.code.xenfright=!0)},onafterload:function(a,b,c,e){var d=e.overlayParams.dialog.replace("bbm_","Bbm_");if(xenMCE.Templates[d]!==g&&xenMCE.Templates[d].onafterload!==g)xenMCE.Templates[d].onafterload(a,b,c,e)},onclose:function(a,b,c,e){var d=e.overlayParams.dialog.replace("bbm_","Bbm_");if(xenMCE.Templates[d]!==g&&xenMCE.Templates[d].onclose!==g)xenMCE.Templates[d].onclose(a,b,c,e)},submit:function(a,b,c,e){var d=e.overlayParams.dialog.replace("bbm_","Bbm_");
xenMCE.Templates[d]!==g&&xenMCE.Templates[d].submit!==g&&xenMCE.Templates[d].submit(a,b,c,e)}});tinymce.create("xenMCE.Plugins.Auto.XenSwitch",{XenSwitch:function(a,b){d.extend(this,a);var c;this.ed=b;c={name:"xen_switch",icon:"xen_switch",iconset:"xenforo",xenfright:!0,tooltip:this.getPhrase("switch_text",0),onclick:d.proxy(this,"wysiwygToBbCode")};b.addButton("xen_switch",c);b.addMenuItem("xen_switch",d.extend({},c,{text:"Bb Code editor",tooltip:!1}))},wysiwygToBbCode:function(a){1==this.isFullscreen()&&
(a=this.getButtonByName("fullscreen"),0!=a&&d(a).trigger("click"));a={content:this.ed.getContent()};this.ed.fire("XenSwitchToBbCode",a);(a=a.content)?XenForo.ajax("index.php?editor/to-bb-code",{html:a},d.proxy(this,"wysiwygToBbCodeSuccess")):this.wysiwygToBbCodeSuccess({bbCode:""})},wysiwygToBbCodeSuccess:function(a){if(!XenForo.hasResponseError(a)&&a.bbCode!==g){a.isConnected===g||a.isConnected||this.ed.windowManager.alert(a.notConnectedMessage);var b=d(this.ed.getContainer()),c=d(this.ed.getElement()),
e=d('<div class="bbCodeEditorContainer" />'),h=d('<textarea class="textCtrl Elastic" rows="5" />');if(!c.attr("disabled")){var f=c.attr("name").replace(/_html(]|$)/,"");h.attr("id",f).attr("name",f).val(a.bbCode).appendTo(e);d("<a />").attr("href","javascript:").text(this.getPhrase("switch_text",1)).click(d.proxy(this,"bbCodeToWysiwyg")).appendTo(d("<div />").appendTo(e));c.attr("disabled",!0);b.after(e).hide();e.xfActivate();h.focus();this.$bbCodeTextContainer=e;this.$bbCodeTextArea=h}}},bbCodeToWysiwyg:function(){var a=
this.stripTags(this.$bbCodeTextArea.val());a&&"&nbsp;"!=a?XenForo.ajax("index.php?editor/to-html",{bbCode:this.$bbCodeTextArea.val()},d.proxy(this,"bbCodeToWysiwygSuccess")):this.bbCodeToWysiwygSuccess({html:""})},bbCodeToWysiwygSuccess:function(a){if(!XenForo.hasResponseError(a)&&a.html!=g){a.isConnected===g||a.isConnected||this.ed.windowManager.alert(a.notConnectedMessage);var b=d(this.ed.getContainer()),c=d(this.ed.getElement());c.attr("disabled")&&(c.attr("disabled",!1),b.show(),a={content:a.html},
this.ed.fire("XenSwitchToWysiwyg",a),this.ed.setContent(a.content),this.ed.focus(),this.$bbCodeTextContainer.remove())}}});tinymce.create("xenMCE.Plugins.Auto.XenFonts",{XenFonts:function(a,b){var c,e="",h=a.getParam("smallFontBtn");c=!0===a.isOldXen?"xx-small|x-small|small|medium|large|x-large|xx-large":"9px|10px|12px|15px|18px|22px|26px";for(var f=1;8>f;f++)e+=a.getPhrase("size")+" "+f,7!=f&&(e+="|");c=a.buildMenuItems(e,c,"font-size:{v}","xen-font-size");var e=function(a,c){b.on("postrender",function(){var c=
d(b.getContainer()),e=!1,f=function(){var b=c.width();450>b||h?(a.resetText=!0,a.text(""),e||(a.icon(a._name+" mce-xenforo-icons"),a.classes.remove("fixed-width"),e=!0)):450<=b&&e&&(a.resetText=!1,a.text(function(){var b=a._value,c=a.settings.text;null!=b&&d.each(a._values,function(a,e){if(e.value==b)return c=e.text,!1});return c}()),a.icon(!1),a.classes.add("fixed-width"),e=!1)};f();a.on("click",f);d(A).resize(f)})},l=function(a){if(a=a.menu){a=d(a.getEl()).children().first();var b=a.find('[aria-pressed="true"]');
b.length?a.scrollTop(a.scrollTop()+b.position().top):a.scrollTop(0)}};c={name:"xen_fontsize",type:"listbox",icon:!1,fixedWidth:!0,text:a.getPhrase("font_size"),values:c,onPostRender:a.createListBoxChangeHandler(c,"fontsize",e),onShow:function(b){b.control.classes.add("xen-font-size-menu");b.control.initLayoutRect();a.fixBtnFullscreen(this,"menu");l(this)},onclick:function(a){a.control.settings.value&&b.execCommand("FontSize",!1,a.control.settings.value)}};b.addButton("xen_fontsize",c);c="Andale Mono|Arial|Arial Black|Book Antiqua|Courier New|Georgia|Helvetica|Impact|Tahoma|Times New Roman|Trebuchet MS|Verdana";
var f="andale mono,times|arial,helvetica,sans-serif|arial black,avant garde|book antiqua,palatino|courier new,courier|georgia,palatino|helvetica|impact,chicago|tahoma,arial,helvetica,sans-serif|times new roman,times|trebuchet ms,geneva|verdana,geneva",k=b.getParam("font_formats");if(k!=g){var k=k.split(";"),m=[],n=[];d.each(k,function(a,b){b=b.split("=");m.push(b[0]);n.push(b[1])});c=m.join("|");f=n.join("|")}c=a.buildMenuItems(c,f,"font-family:{v}","xen-font-family");e={name:"xen_fontfamily",type:"listbox",
icon:!1,fixedWidth:!0,text:a.getPhrase("font_family"),values:c,onPostRender:a.createListBoxChangeHandler(c,"fontname",e),onShow:function(b){b.control.classes.add("xen-font-family-menu");b.control.initLayoutRect();a.fixBtnFullscreen(this,"menu");l(this)},onclick:function(a){a.control.settings.value&&b.execCommand("FontName",!1,a.control.settings.value)}};b.addButton("xen_fontfamily",e);var r={};d.each(c,function(a,b){r[b.title.toLowerCase()]=b.value});b.on("preInit",function(){b.on("PreProcess SetContent",
function(a){var c=b.dom;tinymce.each(c.select("span",a.node),function(a){var b=a.style.fontFamily;b&&(b=b.toLowerCase().replace(/'/g,""),"serif"!==b&&r[b]!==g&&c.setStyle(a,"fontFamily",r[b]))})})})}});tinymce.create("xenMCE.Plugins.Auto.Fright",{Fright:function(a,b){if(1!=a.getParam("frightMode"))return!1;d.extend(this,a);var c=this;b.on("postrender",function(a){function h(){f.each(function(){d(this).removeClass("mce-first").removeClass("mce-last")}).first().addClass("mce-first").end().last().addClass("mce-last").end()}
a=d(a.target.contentAreaContainer).prev();var f=c.getButtonsByProperty("xenfright",null,a);a=a.find(".mce-toolbar").first();if(!f.length)return!1;b.addCommand("resetFright",h);if(0< !f.length)return!1;f.click(function(){setTimeout(function(){h()},0)});h();var g=d('<div id="mce-top-right" class="mce-container mce-flow-layout-item mce-btn-group" role="toolbar" />');d('<div id="mce-top-right-body" />').append(f).prependTo(g);g.prependTo(a);b.on("FullscreenStateChanged",function(){h()})})}});tinymce.create("xenMCE.Plugins.Auto.Modal",
{Modal:function(a,b){b.on("XenModalComplete",function(b){var e=b.modal,h=b.args;b=b.params;var f=d(e.getEl()),l=!1,k=f.find(".noResponsive").length?!0:!1;1<=f.find(".mce-charmap").length&&(l="modal-mce-charmap",f.children(".mce-container-body").addClass("mainBodyOverflow"));b&&b.disableResponsive!==g&&(k=b.disableResponsive);h&&h.disableResponsive!==g&&(k=h.disableResponsive);if(!0===a.isOldXen||a.getParam("disableResponsive"))k=!0;k||a.responsiveModal(e);h&&h.modalClassName!==g&&(l=h.modalClassName);
b&&b.modalClassName!==g&&(l=b.modalClassName);l&&e.classes.add(l)})}});tinymce.create("xenMCE.Plugins.Auto.quirks",{quirks:function(a,b){b.on("focus",function(a){$container=d(b.getContainer());$container.parents("form").hasClass("InlineMessageEditor")&&(console.log("bouh"),tinyMCE.activeEditor.execCommand("mceAutoResize",!1,a))});b.on("BeforeSetContent",function(c){function h(a){return/^(?:[\s]+)?<img[^>]*?\/>(?:[\s]+)?$/.test(a)}function f(a){var b=/(class="[^"]+?(?="))/;return a=b.test(a)?a.replace(b,
"$1 "+g):a.replace(/(<img)/,'$1 class="'+g+'" ')}if(a.getParam("extendInsert")){var g="tmp_"+(new Date).getTime().toString(16);h(c.content)&&(c.content=f(c.content));b.on("ExecCommand",function(a){if("mceInsertContent"==a.command){var c=b.selection.getBookmark(),e=d(b.getBody()),f=e.find("#"+c.id+"_start"),p=f.offset().top,q=e.parent().add(e);b.selection.moveToBookmark(c);if(f.length){var u={skip_focus:!0};if(h(a.value))e.find("img."+g).one("load",function(a){b.execCommand("mceAutoResize",!1,a,u);
a=d(this);var c=a.offset().top+a.height();a.removeClass(g);q.scrollTop(c)});else q.scrollTop(p),b.execCommand("mceAutoResize",!1,a,u)}}})}});if(!a.isOldXen)return!1;b.on("postrender",function(c){c=b.getDoc();var d=a.getForm();if(!tinymce.isIE&&d.hasClass("InlineMessageEditor"))try{b.settings.readonly||(c.designMode="On")}catch(f){}});if(a.getParam("geckoFullfix")){var c=XenForo._overlayConfig.onBeforeLoad;XenForo._overlayConfig.onBeforeLoad=function(a){if(window.tinyMCE&&tinymce.isGecko&&d(this.getTrigger()).hasClass("edit")&&
($mceTextarea=d(tinyMCE.activeEditor.getElement()),!$mceTextarea.attr("disabled"))){var b=$mceTextarea.attr("id");tinyMCE.execCommand("mceRemoveEditor",!1,b);tinyMCE.execCommand("mceAddEditor",!0,b);tinyMCE.activeEditor.focus()}"function"===typeof c&&c(a)}}}});tinymce.create("xenMCE.Plugins.Auto.TableIntegration",{TableIntegration:function(a,b){this.ed=b;for(var c=function(b){a.handleDisabledState(this,"table")},e=[],h=1;5>h;h++)e.push({text:"Skin "+h,skin:h,onclick:function(a){a=a.control.settings.skin;
var c;c=b.dom.getParent(b.selection.getStart(),"table");c!=g&&($tableElm=d(c),$tableElm.attr("data-skin","skin"+a))},onPostRender:c});b.addMenuItem("xen_tableskin",{name:"xen_tableskin",text:"Table skins",context:"table",onShow:function(a){var c;c=b.dom.getParent(b.selection.getStart(),"table");$skins=d(a.control.getEl()).find(".mce-text");$skins.css("font-weight","normal");if(c!=g&&($tableElm=d(c),a=$tableElm.attr("data-skin"),a!=g)){a=parseInt(a.replace("skin",""));if(isNaN(a)||4<a)return!1;$skins.eq(a-
1).css("font-weight","bold")}},menu:e});b.on("submit",function(a){tinymce.each(b.contextToolbars||[],function(a){a.panel&&a.panel.hide()})})}});tinymce.create("xenMCE.Plugins.Auto.Fullscreen",{Fullscreen:function(a,b){if(!a.isActiveButton("fullscreen"))return!1;if(tinymce.isIE&&7>=tinymce.Env.ie)return delete b.buttons.fullscreen,!1;b.buttons.fullscreen.xenfright=!0;b.on("submit",function(){a.isFullscreen()&&b.execCommand("mceFullScreen")});b.on("FullscreenStateChanged",function(a){$container=d(b.getContainer());
d(a.target.contentDocument).find("html").css("overflow","auto");0==a.state&&(d("html, body").animate({scrollTop:$container.offset().top},300),b.focus())})}});tinymce.create("xenMCE.Plugins.Auto.XenLink",{XenLink:function(a,b){d.extend(this,a);this.ed=b;var c,e;c={name:"xen_link",icon:"link",shortcut:"Ctrl+K",stateSelector:"a[href]",onclick:d.proxy(this,"init")};e={type:"splitbutton",menu:this.buildMenuItems(a.getPhrase("unlink")),onshow:function(a){d(".mce-tooltip:visible").hide()},onselect:function(a){b.execCommand("unlink")}};
a.getParam("fastUnlink")&&d.extend(c,e);e={name:"xen_unlink",icon:"unlink",cmd:"unlink",stateSelector:"a[href]"};b.addButton("xen_link",c);b.addMenuItem("xen_link",d.extend({},c,{type:"menuitem",text:"Link",context:"insert",prependToContext:!0}));b.addButton("xen_unlink",e);b.addMenuItem("xen_unlink",d.extend({},e,{text:"Unlink",tooltip:!1}))},init:function(a){a=this.getParam("overlayLinkSize");config={width:a.w,height:a.h,onsubmit:this.submit};this.loadOverlay("link",config)},submit:function(a,b,
c,e){xenMCE.Templates.Link.submit(a,b,c,e)}});tinymce.create("xenMCE.Plugins.Auto.XenMedia",{XenMedia:function(a,b){d.extend(this,a);this.ed=b;var c;c={name:"xen_media",icon:"media",onclick:d.proxy(this,"init")};b.addButton("xen_media",c);b.addMenuItem("xen_media",d.extend({},c,{text:a.getPhrase("xen_media_desc"),context:"insert",tooltip:!1}))},init:function(a){a=this.getParam("overlayMediaSize");config={width:a.w,height:a.h,onsubmit:this.submit};this.loadOverlay("media",config)},submit:function(a,
b,c,e){xenMCE.Templates.Media.submit(a,b,c,e)}});tinymce.create("xenMCE.Plugins.Auto.XenImage",{XenImage:function(a,b){d.extend(this,a);this.ed=b;var c;c={name:"xen_image",icon:"image",stateSelector:"img:not([data-mce-object],[data-smilie])",onclick:d.proxy(this,"init")};b.addButton("xen_image",c);b.addMenuItem("xen_image",d.extend({},c,{text:"Image",context:"insert",tooltip:!1}))},init:function(a){a=this.ed.selection.getNode();var b=this.getParam("overlayImageSize");config={width:b.w,height:b.h,
onsubmit:this.submit};"IMG"==a.nodeName&&(config.data={url:this.ed.dom.getAttrib(a,"src")});this.loadOverlay("image",config)},submit:function(a,b,c,e){xenMCE.Templates.Image.submit(a,b,c,e)}});tinymce.create("xenMCE.Plugins.Auto.XenCode",{XenCode:function(a,b){d.extend(this,a);var c;this.ed=b;c={name:"xen_code",icon:"xen_code",iconset:"xenforo",onclick:d.proxy(this,"init")};b.addButton("xen_code",c);b.addMenuItem("xen_code",d.extend({},c,{text:a.getPhrase("xen_code_desc"),context:"insert",tooltip:!1}))},
init:function(a){config={width:480,height:300,onsubmit:this.submit};this.loadOverlay("code",config)},submit:function(a,b,c,e){xenMCE.Templates.Code.submit(a,b,c,e)}});tinymce.create("xenMCE.Plugins.Auto.XenQuote",{XenQuote:function(a,b){var c;c={name:"xen_quote",icon:"xen_quote",iconset:"xenforo",onclick:function(b){a.insertBbCode("quote",!1)}};b.buttons.xen_quote===g&&(b.addButton("xen_quote",c),b.addMenuItem("xen_quote",d.extend({},c,{text:a.getPhrase("xen_quote_desc"),context:"insert",tooltip:!1})))}});
tinymce.create("xenMCE.Plugins.Auto.XenSmilies",{XenSmilies:function(a,b){function c(c){function e(b,c){tinymce.each(c,function(c,e){var g=c[1],k=c[0],l=d.encode(e),m=a.getParam("smiliesDesc");"bbcode"==m?k=e:"none"==m&&(k="");if(0!=h&&f>h)return!1;b="number"===typeof g?b+('<a href="#"><img src="styles/default/xenforo/clear.png" alt="'+l+'" title="'+k+'" data-smilie="yes" class="mceQuattroSmilie mceQuattroSmilieSprite mceSmilie'+g+'"  /></a>'):b+('<a href="#"><img src="'+d.encode(g)+'" alt="'+l+'" title="'+
k+'" data-smilie="yes" class="mceQuattroSmilie" /></a>');f++});return b}var d=b.dom||tinymce.DOM,f=1,h,k="",l=a.getParam("xenforo_smilies"),m=a.getParam("smiliesCat"),n=a.getParam("xCatSmilies");!0===c?(h=0,k="Full"):h=a.getParam("xSmilies");var t='<div role="presentation" class="mceQuattroSmilieBlock'+k+' responsiveBlock">';m?!0!==c&&-1!=n&&l[n]!==g?t+=e("",l[n].smilies):tinymce.each(l,function(b,d){var f=b.title?b.title:a.getPhrase("uncat_smilies");!0===c?(t+='<p class="mce_smilie_cat_title">'+
f+"</p>",t+='<div class="mce_smilie_cat">'+e("",b.smilies)+"</div>"):t+=e("",b.smilies)}):t=e(t,l);return t+="</div>"}function e(){var a={type:"container",html:c(!0),onclick:function(a){a.preventDefault();if(a=b.dom.getParent(a.target,"a"))a=d(a).html(),b.execCommand("mceInsertContent",!1,a)}},e=b.windowManager.open({title:"Smilies picker",spacing:10,padding:10,items:[a],buttons:[{text:"Close",onclick:function(){e.close()}}]},{modalClassName:"modal-smilies"})}d.extend(this,a);var h=this,f=a.getParam("smiliesWindow"),
l=a.getParam("showSmilieItemWin"),k={autohide:!0,html:function(){return c()},onclick:function(a){var c=b.dom.getParent(a.target,"a");c&&(c=d(c).html(),b.execCommand("mceInsertContent",!1,c),a.dontHide!=g&&a.dontHide||this.hide())}},m={name:"xen_smilies",icon:"emoticons",type:"panelbutton",stateSelector:"img[data-smilie]",popoverAlign:"bc-tl",panel:k},n={name:"xen_smilies_picker",icon:"xen_smilies_picker",iconset:"xenforo",tooltip:"Smilies picker",stateSelector:"img[data-smilie]"};n.onclick="slider"==
f?d.proxy(this,"initOvl"):"belowbox"!=f||this.isOldXen?e:function(a){h.isFullscreen()?e():h.initBox(this,a,b)};b.addButton("xen_smilies",m);b.addButton("xen_smilies_picker",n);f=d.extend({},m,{text:"Smilies",tooltip:!1,type:"menuitem",context:"insert",autohide:!1,panel:!1,align:"center",onclick:function(a){d.extend(this,{mirrorClick:n.onclick});this.mirrorClick(a);this.hideMenu().parent().hide()}});l&&(f.menu=[{type:"container",html:c(),classes:"quattro-menu-smilies",onclick:function(a){a.preventDefault();
a.dontHide=!0;k.onclick(a);a.stopPropagation()}}]);b.addMenuItem("xen_smilies",f);b.addMenuItem("xen_smilies_picker",d.extend({},n,{text:"Smilies picker",context:"insert",tooltip:!1}))},initOvl:function(a){a=this.getParam("overlaySmiliesSize");config={width:parseInt(a.w),height:parseInt(a.h)};callbacks={src:this,onafterload:"onafterload"};this.loadOverlay("smilies_slider",config,callbacks)},onafterload:function(a,b,c,e){xenMCE.Templates.SmiliesSlider.init(a,b,c,e)},initBox:function(a,b,c){var e=this,
h=d(c.getContainer()).parent(),f=h.find(".redactor_smilies");f.length?f.slideToggle("slow",function(){a.active(f.is(":visible"))}):e.smiliesPending||(e.smiliesPending=!0,XenForo.ajax("index.php?editor/smilies",{mce:"mce4"},function(a){XenForo.hasResponseError(a)||a.templateHtml&&new XenForo.ExtLoader(a,function(){f=d('<div class="redactor_smilies mce" />').html(a.templateHtml);f.hide();f.on("click",".Smilie",function(a){a.preventDefault();a=d(this);a=d.trim(a.html());c.execCommand("mceInsertContent",
!1,a);c.focus()});h.append(f);f.xfActivate();f.slideToggle()})}).complete(function(){e.smiliesPending=!1;a.active(!0)}))}});tinymce.create("xenMCE.Plugins.Auto.XenNonBreaking",{XenNonBreaking:function(a,b){var c;b.addCommand("XenNonBreaking",function(){b.insertContent(b.plugins.visualchars&&b.plugins.visualchars.state?'<span data-mce-bogus="1" class="mce-nbsp">&nbsp;</span>':"&nbsp;")});c={name:"xen_nonbreaking",cmd:"XenNonBreaking"};b.addButton("xen_nonbreaking",c);b.addMenuItem("xen_nonbreaking",
d.extend({},c,{text:"Non-breaking space",context:"insert",tooltip:!1}));if(b.getParam("nonbreaking_force_tab"))b.on("keydown",function(a){if(9==a.keyCode)for(a.preventDefault(),a=0;4>a;)b.execCommand("XenNonBreaking"),a++})}});tinymce.create("xenMCE.Plugins.Auto.XenDraft",{XenDraft:function(a,b){if(a.isOldXen)return!1;d.extend(this,{ed:b,getForm:a.getForm,draftText:a.getPhrase("draft"),$textarea:a.$textarea,autoSaveUrl:a.$textarea.data("auto-save-url")});var c=this,e;this.autoSaveUrl&&a.getParam("xendraft")?
(console.info("Draft mode: Xen"),e=a.buildMenuItems(c.draftText.save+"|"+c.draftText._delete,"saveDraft|deleteDraft",null,"xen_draft"),b.on("BeforeRenderUI",function(b){if(!a.isActiveButton("restoredraft"))return!1}),e={name:"restoredraft",title:c.draftText.save,type:"menubutton",menu:e,onselect:function(a){c.saveDraft(!0,"deleteDraft"==a.control.settings.value)}},b.addButton("restoredraft",e),b.addMenuItem("restoredraft",d.extend({},e,{separator:"before",text:c.draftText.save,tooltip:!1,type:!1})),
b.on("init",function(b){c.pathEl=a.getPathEl(!0);c.initAutoSave()}),b.addCommand("xenDraftSave",function(){c.saveDraft(!0)}),b.addCommand("xenDraftDelete",function(){c.saveDraft(!0,!0)})):console.info("Draft mode: Mce")},initAutoSave:function(){var a=this,b=this.getForm(),c=a.$textarea.data("options"),e=this.ed.getContent();if(b.length){this.lastAutoSaveContent=e;var d=setInterval(function(){a.$textarea.data("mce4")?a.saveDraft():clearInterval(d)},1E3*(c.autoSaveFrequency||60))}},saveDraft:function(a,
b){var c=this,e=this.getForm(),h=this.ed.windowManager,f={content:this.ed.getContent()},g="";this.ed.fire("SavingXenDraft",f);g=f.content;if(!b&&!a&&g==this.lastAutoSaveContent)return!1;this.lastAutoSaveContent=g;f=d.Event("BbCodeWysiwygEditorAutoSave");f.editor=this;f.content=g;f.deleteDraft=b;e.trigger(f);if(f.isDefaultPrevented()||this.autoSaveRunning)return!1;this.autoSaveRunning=!0;XenForo.ajax(this.autoSaveUrl,e.serialize()+(b?"&delete_draft=1":""),function(f){var g=d.Event("BbCodeWysiwygEditorAutoSaveComplete");
g.ajaxData=f;e.trigger(g);if(!g.isDefaultPrevented()){var l;f.draftSaved?l=c.draftText.saved:f.draftDeleted&&(l=c.draftText.deleted);l&&(a||b?h.alert(l):0==c.pathEl?console.log(c.draftText.saved):($path=c.pathEl,d('<div class="draftNotice"><span>'+l+"</span></div>").insertAfter($path).css({display:"inline-block",padding:"8px"}).finish().hide().fadeIn().delay(2E3).fadeOut()))}},{global:!1}).complete(function(){c.autoSaveRunning=!1});return!0}});tinymce.create("xenMCE.Plugins.Auto.XenSpoiler",{XenSpoiler:function(a,
b){var c;c={name:"xen_spoiler",icon:"xen_spoiler",iconset:"xenforo",tooltip:"Insert spoiler",onclick:function(c){b.windowManager.open({title:"Insert spoiler",body:[{name:"title",type:"textbox",size:40,label:"Spoiler Title"}],onSubmit:function(c){c=c.data.title;var e=b.selection.getContent();a.insertBbCode("spoiler",c,e)}})}};b.addButton("xen_spoiler",c);b.addMenuItem("xen_spoiler",d.extend({},c,{text:"Spoiler",tooltip:!1,context:"insert"}))}});tinymce.create("xenMCE.Plugins.Auto.XenToggleMenu",{XenToggleMenu:function(a,
b){b.on("init",function(e){1==a.getParam("tglMenuCollasped")&&b.getParam("menubar")&&(a.getToolbars().hide(),c())});var c=function(){var b=a.getMenubar();a.getToolbars().visible()?b.css("borderWidth","0 0 1px"):b.css("borderWidth",0)};b.addMenuItem("togglemenu",{name:"togglemenu",selectable:!0,onClick:function(b){b=a.getToolbars();b.visible()?b.hide():b.show();this.active(b.visible());c()},text:"Show full editor",context:"view",onPostRender:function(b){function c(){var b=a.getToolbars();d.disabled(0==
b.length);d.active(b.visible())}var d=this;c();d.parent().on("show",function(){a.isFullscreen()?d.disabled(!0):c()})}});b.addCommand("xenFullEditor",function(b){var d=a.getToolbars();b||b===g?d.show():d.hide();c()});b.on("FullscreenStateChanged",function(a){b.execCommand("xenFullEditor",!0)})}});tinymce.create("xenMCE.Plugins.Auto.XenAnchor",{XenAnchor:function(a,b){a.alterTagBeforeComplete("a",function(a,b){if(a.hasClass(b,"mce-item-anchor")){var d=a.getAttrib(b,"id");return a.create("anchor",{id:d},
"mce-anchor")}return!1})}});tinymce.create("xenMCE.Plugins.Auto.CustomFormats",{CustomFormats:function(a,b){a.alterTagBeforeComplete(".quattro_sf",function(a,b){var d=b.nodeName,f=!1;-1!==tinymce.inArray("H1 H2 H3 H4 H5 H6".split(" "),d)?f=d.toLowerCase():a.hasClass(b,"cust1")?f="cust1":a.hasClass(b,"cust2")?f="cust2":a.hasClass(b,"cust3")&&(f="cust3");return f?(d=b.innerHTML,a.create("xformat",{name:f},d)):!1},!0)}});tinymce.create("xenMCE.Plugins.Auto.XenIcons",{XenIcons:function(a,b){function c(a){b.buttons[a].type!==
g&&(b.buttons[a].type="button")}var e=tinymce.each;b.on("BeforeRenderUI",function(c){var d=function(a){b.menuItems[a]!==g&&delete b.menuItems[a]};a.isActiveButton("xen_link")||d("xen_link");a.isActiveButton("table")||e("inserttable xen_tableskin cell row column deletetable".split(" "),function(a){d(a)})});e(b.buttons,function(c,d){var e=d+"_desc";XenForo.isTouchBrowser()?b.buttons[d].tooltip!==g&&delete b.buttons[d].tooltip:(e=a.getPhrase(e),e.length&&(b.buttons[d].tooltip=e))});1!=a.getParam("extraLists")&&
(c("bullist"),c("numlist"));b.on("init",function(c){c=a.getButtonsByProperty("iconset","xenforo",!0);a.addIconClass(c,"xenforo");c=b.theme.panel.find("menubar menubutton");e(c,function(b,c){b.on("show",function(c){var h=c.control.find("menuitem");e(h,function(b){b.settings!=g&&"xenforo"==b.settings.iconset&&a.addIconClass(d(b.getEl()),"xenforo")});h=c.control.parent();h!==g&&"menubutton"==h.type&&a.fixBtnFullscreen(b,!1,c.control)})});(c=b.theme.panel.find("#statusbar"))&&0<c.length&&($statBar=d(c[0].getEl()));
a.getParam("hidePath")&&0<c.length&&$statBar.find(".mce-path").css("visibility","hidden")})}})})(jQuery,this,document);